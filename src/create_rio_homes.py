#Encoding: UTF-8

lines = {'1': [], '10': [], '100': [], '101': [], '102': [], '104': [], '105': [], '106': [], '107': [], '108': [], '109': [], '11': [], '110': [], '111': [], '112': [], '117': [], '118': [], '133': [], '134': [], '14': [], '17': [], '2': [], '201': [], '2018': [], '202': [], '203': [], '209': [], '210': [], '2110': [], '2111': [], '2112': [], '2114': [], '2115': [], '213': [], '217': [], '218': [], '220': [], '222': [], '2251': [], '226': [], '229': [], '2303': [], '2305': [], '2307': [], '2308': [], '2309': [], '2310': [], '232': [], '2329': [], '2330': [], '2331': [], '2332': [], '2333': [], '2334': [], '2335': [], '2336': [], '2337': [], '2338': [], '2339': [], '2342': [], '2343': [], '2344': [], '2345': [], '238': [], '2381': [], '2382': [], '2383': [], '239': [], '247': [], '249': [], '254': [], '265': [], '275': [], '277': [], '2801': [], '2802': [], '2803': [], '2804': [], '2918': [], '292': [], '296': [], '298': [], '301': [], '302': [], '303': [], '306': [], '309': [], '311': [], '312': [], '313': [], '315': [], '321': [], '322': [], '323': [], '324': [], '325': [], '326': [], '327': [], '328': [], '329': [], '330': [], '331': [], '334': [], '335': [], '338': [], '339': [], '341': [], '342': [], '343': [], '345': [], '346': [], '348': [], '349': [], '350': [], '352': [], '353': [], '355': [], '358': [], '361': [], '362': [], '363': [], '366': [], '368': [], '369': [], '370': [], '371': [], '378': [], '379': [], '380': [], '383': [], '384': [], '385': [], '386': [], '388': [], '389': [], '390': [], '391': [], '392': [], '393': [], '394': [], '395': [], '396': [], '397': [], '398': [], '399': [], '404': [], '409': [], '410': [], '415': [], '416': [], '422': [], '426': [], '432': [], '433': [], '434': [], '435': [], '436': [], '439': [], '440': [], '441': [], '444': [], '445': [], '448': [], '455': [], '456': [], '457': [], '460': [], '461': [], '462': [], '463': [], '464': [], '471': [], '472': [], '473': [], '474': [], '476': [], '483': [], '484': [], '485': [], '497': [], '498': [], '503': [], '507': [], '513': [], '517': [], '538': [], '539': [], '548': [], '550': [], '551': [], '552': [], '553': [], '554': [], '555': [], '557': [], '558': [], '565': [], '580': [], '581': [], '582': [], '583': [], '584': [], '6': [], '600': [], '601': [], '603': [], '605': [], '606': [], '607': [], '608': [], '610': [], '611': [], '613': [], '614': [], '615': [], '616': [], '621': [], '622': [], '623': [], '624': [], '625': [], '626': [], '627': [], '628': [], '629': [], '630': [], '634': [], '636': [], '638': [], '639': [], '650': [], '651': [], '652': [], '653': [], '663': [], '665': [], '667': [], '669': [], '678': [], '679': [], '680': [], '685': [], '686': [], '687': [], '688': [], '691': [], '692': [], '693': [], '696': [], '7': [], '709': [], '711': [], '712': [], '721': [], '723': [], '731': [], '737': [], '739': [], '741': [], '743': [], '744': [], '745': [], '746': [], '752': [], '755': [], '756': [], '759': [], '769': [], '770': [], '771': [], '772': [], '773': [], '774': [], '775': [], '777': [], '778': [], '779': [], '781': [], '782': [], '783': [], '784': [], '786': [], '789': [], '790': [], '793': [], '794': [], '795': [], '801': [], '802': [], '803': [], '804': [], '805': [], '809': [], '810': [], '811': [], '812': [], '813': [], '817': [], '819': [], '821': [], '822': [], '823': [], '825': [], '828': [], '829': [], '830': [], '831': [], '832': [], '833': [], '834': [], '835': [], '836': [], '837': [], '838': [], '839': [], '840': [], '841': [], '842': [], '843': [], '844': [], '845': [], '846': [], '847': [], '848': [], '849': [], '850': [], '851': [], '852': [], '853': [], '854': [], '855': [], '858': [], '859': [], '860': [], '861': [], '862': [], '863': [], '864': [], '865': [], '866': [], '867': [], '868': [], '869': [], '870': [], '871': [], '872': [], '874': [], '875': [], '876': [], '877': [], '878': [], '880': [], '881': [], '882': [], '883': [], '884': [], '885': [], '886': [], '887': [], '891': [], '892': [], '893': [], '895': [], '896': [], '897': [], '898': [], '900': [], '901': [], '905': [], '906': [], '908': [], '910': [], '913': [], '914': [], '915': [], '916': [], '917': [], '918': [], '919': [], '920': [], '922': [], '923': [], '924': [], '925': [], '926': [], '932': [], '934': [], '935': [], '936': [], '939': [], '940': [], '942': [], '944': [], '945': [], '946': [], '950': [], '951': [], '953': [], '954': [], '955': [], '963': [], '991': [], 'LECD23': [], 'LECD28': [], 'LECD29': [], 'SE940': [], 'SN392': [], 'SN393': [], 'SN397': [], 'SN819': [], 'SP2381': [], 'SP265': [], 'SP292': [], 'SP343': [], 'SP393': [], 'SP404': [], 'SP513': [], 'SP553': [], 'SP801': [], 'SP803': [], 'SP841': [], 'SP850': [], 'SR335': [], 'SR393': [], 'SR397': [], 'SV232': [], 'SV2333': [], 'SV335': [], 'SV455': [], 'SV474': [], 'SV498': [], 'SV606': [], 'SV774': [], 'SV779': [], 'SV790': [], 'SV843': [], 'SV853': [], 'SV866': [], 'SV870': [], 'SV901': [], 'SV917': [], 'SV920': [], 'SV942': [], 'SVA685': [], 'SVA905': [], 'SVB685': [], 'SVB905': [], 'SVC905': []}

import requests

lines_url = 'https://rjbr.org/o/onibus/linhas/'

page_text = requests.get(lines_url).text

lines_keys = lines.keys()

def get_url(line, html):
    line_url_start = lines_url + line + '-'
    return line_url_start + html.split(line_url_start)[1].split('\"')[0]

success = 0
failure = 0
new_lines = {}
for line in lines_keys:
    try:
        line_url = get_url(line, page_text)
        line_url_response = requests.get(line_url)
        line_url_response.encoding = 'utf-8'
        line_url_text = line_url_response.text
        initial_stop = line_url_text.split('<h3')[1].split('address\">')[1].split('<')[0]
        final_stop = line_url_text.split('<h3')[2].split('address\">')[1].split('<')[0]

        new_lines[line] = [initial_stop, final_stop]

        success += 1
    except:
        failure += 1

print(success/(success + failure))
print(new_lines)